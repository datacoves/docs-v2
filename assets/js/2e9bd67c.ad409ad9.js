"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9353],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(96540);const o={},i=s.createContext(o);function r(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(i.Provider,{value:n},e.children)}},64661:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"how-tos/airflow/dynamically-set-schedule","title":"DAGs - Dynamically Set Schedule","description":"By default, DAGs are created with a paused state in Airflow, but you can change this with the ispausedon_creation=True option. However, you will likely not want to schedule DAGs in a development Airflow instance. The steps below describe how do not set a schedule in a Development Airflow instance.","source":"@site/docs/how-tos/airflow/dynamically-set-schedule.md","sourceDirName":"how-tos/airflow","slug":"/how-tos/airflow/dynamically-set-schedule","permalink":"/docusaurus-test/docs/how-tos/airflow/dynamically-set-schedule","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/how-tos/airflow/dynamically-set-schedule.md","tags":[],"version":"current","sidebarPosition":22,"frontMatter":{"title":"DAGs - Dynamically Set Schedule","sidebar_position":22},"sidebar":"tutorialSidebar","previous":{"title":"DAGs - Calling External Python Scripts","permalink":"/docusaurus-test/docs/how-tos/airflow/external-python-dag"},"next":{"title":"DAGs - Generate DAGs from yml","permalink":"/docusaurus-test/docs/how-tos/airflow/generate-dags-from-yml"}}');var o=t(74848),i=t(28453);const r={title:"DAGs - Dynamically Set Schedule",sidebar_position:22},a="How to Dynamically set the schedule Interval",l={},d=[];function c(e){const n={a:"a",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"how-to-dynamically-set-the-schedule-interval",children:"How to Dynamically set the schedule Interval"})}),"\n",(0,o.jsxs)(n.p,{children:["By default, DAGs are created with a ",(0,o.jsx)(n.code,{children:"paused"})," state in Airflow, but you can change this with the ",(0,o.jsx)(n.code,{children:"is_paused_on_creation=True"})," option. However, you will likely not want to schedule DAGs in a development Airflow instance. The steps below describe how do not set a schedule in a Development Airflow instance."]}),"\n",(0,o.jsx)(n.p,{children:"You can dynamically set the DAG schedule based on your Datacoves environment (development or production). By using a function called get_schedule, you can ensure that the correct schedule is applied only in the production Airflow instance."}),"\n",(0,o.jsx)(n.p,{children:"Here is how to achieve this:"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 1:"})," Create a ",(0,o.jsx)(n.code,{children:"get_schedule.py"})," file inside of ",(0,o.jsx)(n.code,{children:"orchestrate/utils"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 2:"})," Paste the following code:\nNote: Find your environment slug ",(0,o.jsx)(n.a,{href:"/docusaurus-test/docs/reference/admin-menu/environments",children:"here"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'# get_schedule.py\nimport os\nfrom typing import Union\n\nDEV_ENVIRONMENT_SLUG = "dev123" # Replace with your environment slug\n\ndef get_schedule(default_input: Union[str, None]) -> Union[str, None]:\n    """\n    Sets the application\'s schedule based on the current environment setting. Allows you to\n    set the the default for dev to none and the the default for prod to the default input.\n\n    This function checks the Datacoves Slug through \'DATACOVES__ENVIRONMENT_SLUG\' variable to determine\n    if the application is running in a specific environment (e.g., \'dev123\'). If the application\n    is running in the \'dev123\' environment, it indicates that no schedule should be used, and\n    hence returns None. For all other environments, the function returns the given \'default_input\'\n    as the schedule.\n\n   Parameters:\n    - default_input (Union[str, None]): The default schedule to return if the application is not\n      running in the dev environment.\n\n    Returns:\n    - Union[str, None]: The default schedule if the environment is not \'dev123\'; otherwise, None,\n      indicating that no schedule should be used in the dev environment.\n    """\n    env_slug = os.environ.get("DATACOVES__ENVIRONMENT_SLUG", "").lower()\n    if env_slug == DEV_ENVIRONMENT_SLUG:\n        return None\n    else:\n        return default_input\n'})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Step 3:"})," In your DAG, import the ",(0,o.jsx)(n.code,{children:"get_schedule"})," function using ",(0,o.jsx)(n.code,{children:"from orchestrate.utils.get_schedule import get_schedule"})," and pass in your desired schedule."]}),"\n",(0,o.jsxs)(n.p,{children:["ie) If your desired schedule is ",(0,o.jsx)(n.code,{children:"'0 1 * * *'"})," then you will set ",(0,o.jsx)(n.code,{children:"schedule=get_schedule('0 1 * * *')"})," as seen in the example below."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'from airflow.decorators import dag, task\nfrom pendulum import datetime\nfrom orchestrate.utils.get_schedule import get_schedule\n\n@dag(\n    default_args={\n        "start_date": datetime(2022, 10, 10),\n        "owner": "Noel Gomez",\n        "email": "gomezn@example.com",\n        "email_on_failure": True,\n    },\n    is_paused_on_creation=True, \n    catchup=False,\n    tags=["version_8"],\n    description="Datacoves Sample DAG",\n    schedule=get_schedule(\'0 1 * * *\'),  # Replace with desired schedule\n)\ndef datacoves_sample_dag():\n    \n    @task.datacoves_dbt(connection_id="main")\n    def run_dbt_task():\n        return "dbt debug"\n\n    run_dbt_task()\n\ndatacoves_sample_dag()\n'})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);