"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3324],{28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>a});var t=r(96540);const o={},i=t.createContext(o);function s(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(i.Provider,{value:n},e.children)}},47084:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/admin-connections-8f6e6d9caa31fe197b2f95b1b55f0de8.png"},54016:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/fivetran_connector_id-9521f016104a5f9adb02a8ae10868941.png"},65244:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/fivetran-connection-details-bcf2f8b89ee91f331d6337a147ecef1e.png"},72290:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"how-tos/airflow/run-fivetran-sync-jobs","title":"DAGs - Run Fivetran sync jobs","description":"In Addition to triggering Airbyte loads jobs run Airbyte sync jobs you can also trigger Fivetran jobs from your Airflow DAG.","source":"@site/docs/how-tos/airflow/run-fivetran-sync-jobs.md","sourceDirName":"how-tos/airflow","slug":"/how-tos/airflow/run-fivetran-sync-jobs","permalink":"/docusaurus-test/docs/how-tos/airflow/run-fivetran-sync-jobs","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":31,"frontMatter":{"title":"DAGs - Run Fivetran sync jobs","sidebar_position":31},"sidebar":"tutorialSidebar","previous":{"title":"DAGs - Run Databricks Notebooks","permalink":"/docusaurus-test/docs/how-tos/airflow/run-databricks-notebook"},"next":{"title":"DAGs - Test DAGs","permalink":"/docusaurus-test/docs/how-tos/airflow/test-dags"}}');var o=r(74848),i=r(28453);const s={title:"DAGs - Run Fivetran sync jobs",sidebar_position:31},a="Run Fivetran sync jobs",c={},d=[{value:"Before you start",id:"before-you-start",level:2},{value:"Ensure your Airflow environment is properly configured",id:"ensure-your-airflow-environment-is-properly-configured",level:3},{value:"Fivetran connection",id:"fivetran-connection",level:3},{value:"Configure your transform/.dbt-coves/config.yml file",id:"configure-your-transformdbt-covesconfigyml-file",level:3},{value:"Field reference:",id:"field-reference",level:3},{value:"Example DAG",id:"example-dag",level:2},{value:"Python version",id:"python-version",level:3},{value:"Fields reference",id:"fields-reference",level:3},{value:"YAML version",id:"yaml-version",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"run-fivetran-sync-jobs",children:"Run Fivetran sync jobs"})}),"\n",(0,o.jsxs)(n.p,{children:["In Addition to triggering Airbyte loads jobs ",(0,o.jsx)(n.a,{href:"/docs/how-tos/airflow/run-airbyte-sync-jobs",children:"run Airbyte sync jobs"})," you can also trigger Fivetran jobs from your Airflow DAG."]}),"\n",(0,o.jsx)(n.h2,{id:"before-you-start",children:"Before you start"}),"\n",(0,o.jsx)(n.h3,{id:"ensure-your-airflow-environment-is-properly-configured",children:"Ensure your Airflow environment is properly configured"}),"\n",(0,o.jsxs)(n.p,{children:["Follow this guide on ",(0,o.jsx)(n.a,{href:"/docs/how-tos/airflow/initial-setup",children:"How to set up Airflow"}),"'s environment."]}),"\n",(0,o.jsx)(n.h3,{id:"fivetran-connection",children:"Fivetran connection"}),"\n",(0,o.jsx)(n.p,{children:"Airflow needs to be connected to your Fivetran account to both read and trigger your Connectors, so first you need to set up a connection."}),"\n",(0,o.jsxs)(n.p,{children:["A user with Airflow admin privileges must go to the Airflow ",(0,o.jsx)(n.code,{children:"Admin -> Connections"})," menu."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Admin Connections",src:r(47084).A+"",width:"1126",height:"468"})}),"\n",(0,o.jsx)(n.p,{children:"Create a new connection using the following details:"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Admin Connections",src:r(65244).A+"",width:"1778",height:"990"})}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["Once your Fivetran API key and secret have been generated, for security reasons, the secret cannot be viewed again through the Fivetran interface. If you lose or forget your API secret, you will need to generate a new API key and secret pair so be sure to store them somewhere secure for reference later. See ",(0,o.jsx)("a",{href:"https://fivetran.com/docs/rest-api/getting-started",target:"_blank",rel:"noopener",children:"Fivetran Documentation"})," on how to generate your Fivetran ",(0,o.jsx)(n.code,{children:"API Key"})," and ",(0,o.jsx)(n.code,{children:"API Secret"}),"."]})}),"\n",(0,o.jsx)(n.h3,{id:"configure-your-transformdbt-covesconfigyml-file",children:"Configure your transform/.dbt-coves/config.yml file"}),"\n",(0,o.jsx)(n.p,{children:"By default, dbt-coves cannot query the necessary information for Fivetran connections. You will need to configure these in your yml DAG manually, or contact us to configure Datacoves with the necessary information.\nBelow are the configurations in for dbt-coves airflow-dags. You will need to configure these if using dbt-coves to generate DAGs from YML"}),"\n",(0,o.jsx)(n.h3,{id:"field-reference",children:"Field reference:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"yml_path"}),": Relative path to dbt project where yml to generate python DAGs will be stored"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"dags_path"}),": Relative path to dbt project where generated python DAGs will be stored"]}),"\n"]}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["We make use of environment variables that we have configured for you upon set up. For more information on these variables please see ",(0,o.jsx)(n.a,{href:"/docusaurus-test/docs/reference/vscode/datacoves-env-vars",children:"Datacoves Environment Variables"})]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"generate:\n...\n  airflow_dags:\n    # source location for yml files\n    yml_path: \"/config/workspace/{{ env_var('DATACOVES__AIRFLOW_DAGS_YML_PATH') }}\"\n\n    # destination for generated python dags\n    dags_path: \"/config/workspace/{{ env_var('DATACOVES__AIRFLOW_DAGS_PATH') }}\"\n"})}),"\n",(0,o.jsx)(n.h2,{id:"example-dag",children:"Example DAG"}),"\n",(0,o.jsx)(n.h3,{id:"python-version",children:"Python version"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'from pendulum import datetime\nfrom airflow.decorators import dag, task, task_group\nfrom fivetran_provider_async.operators import FivetranOperator\nfrom fivetran_provider_async.sensors import FivetranSensor\n\n@dag(\n    default_args={"start_date": datetime(2024, 1, 1)},\n    description="Loan Run",\n    schedule="0 0 1 */12 *",\n    tags=["version_1"],\n    catchup=False,\n)\ndef daily_loan_run():\n\n    @task_group(\n        group_id="extract_and_load_fivetran",\n        tooltip="Fivetran Extract and Load"\n    )\n    def extract_and_load_fivetran():\n\n        fivetran_trigger = FivetranOperator(\n            task_id="datacoves_snowflake_google_analytics_4_trigger",\n            connector_id="speak_menial",\n            do_xcom_push=True,\n            fivetran_conn_id="fivetran_connection",\n        )\n\n        fivetran_sensor = FivetranSensor(\n            task_id="datacoves_snowflake_google_analytics_4_sensor",\n            connector_id="speak_menial",\n            poke_interval=60,\n            fivetran_conn_id="fivetran_connection",\n        )\n\n        fivetran_trigger >> fivetran_sensor  # Ensure proper task execution order\n\n    tg_extract_and_load_fivetran = extract_and_load_fivetran()\n\n    @task.datacoves_dbt(connection_id="main")\n    def transform():\n        return "dbt build -s \'tag:daily_run_fivetran+\'"\n\n    transform_task = transform()\n    transform_task.set_upstream([tg_extract_and_load_fivetran])\n\ndag = daily_loan_run()\n'})}),"\n",(0,o.jsx)(n.h3,{id:"fields-reference",children:"Fields reference"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"extract_and_load_fivetran"}),": The name of the task group. This can be named whatever you like and will show up in airflow.\n",(0,o.jsx)(n.img,{alt:"Extract and Load DAG",src:r(89035).A+"",width:"1552",height:"262"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"tooltip"}),": The tooltip argument allows you to provide explanatory text or helpful hints about specific elements in the Airflow UI"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"tasks"}),": Define all of your tasks within the task group."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["You will need to define two operators: ",(0,o.jsx)(n.code,{children:"fivetran_provider.operators.fivetran.FivetranOperator"})," and ",(0,o.jsx)(n.code,{children:"fivetran_provider.sensors.fivetran.FivetranSensor"})]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"example_task_trigger"}),": Name your trigger task accordingly and define arguments below."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"operator"}),": ",(0,o.jsx)(n.code,{children:"fivetran_provider.operators.fivetran.FivetranOperator"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"connector_id"}),": Find in Fivetran UI. Select your desired source. Click into ",(0,o.jsx)(n.code,{children:"Setup"})," and locate the ",(0,o.jsx)(n.code,{children:"Fivetran Connector ID"})]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Fivetran Connection ID",src:r(54016).A+"",width:"1402",height:"610"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"do_xcom_push"}),":  Indicate that the output of the task should be sent to XCom, making it available for other tasks to use."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"fivetran_conn_id"}),": This is the ",(0,o.jsx)(n.code,{children:"connection_id"})," that was configured above in the Fivetran UI as seen ",(0,o.jsx)(n.a,{href:"#id=fivetran-connection",children:"above"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"example_task_sensor"}),": Name your Sensor task accordingly and define arguments below."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"operator"}),": ",(0,o.jsx)(n.code,{children:"fivetran_provider.sensors.fivetran.FivetranSensor"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"connector_id"}),": Find in Fivetran UI."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"poke_interval"}),": The poke interval is the time in seconds that the sensor waits before rechecking if the connector is done loading data. Defaults to 60."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"fivetran_conn_id"}),": This is the ",(0,o.jsx)(n.code,{children:"connection_id"})," that was configured above in the Fivetran UI as seen ",(0,o.jsx)(n.a,{href:"#id=fivetran-connection",children:"above"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"dependencies"}),": A list of tasks this task depends on."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"yaml-version",children:"YAML version"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'description: "Loan Run"\nschedule: "0 0 1 */12 *"\ntags:\n  - version_1\ndefault_args:\n  start_date: 2024-01-01\ncatchup: false\n\n# DAG Tasks\nnodes:\n  # The name of the task group. Will populate in Airflow DAG\n  extract_and_load_fivetran:\n    type: task_group\n    # Change to fit your use case\n    tooltip: "Fivetran Extract and Load"\n    tasks:\n      # Rename with your desired task name. We recommend the suffix _trigger\n      datacoves_snowflake_google_analytics_4_trigger:\n        operator: fivetran_provider_async.operators.FivetranOperator\n        # Change this to your specific connector ID \n        connector_id: speak_menial\n        do_xcom_push: true\n        fivetran_conn_id: fivetran_connection\n      # Rename with your desired task name. We recommend the suffix _sensor\n      datacoves_snowflake_google_analytics_4_sensor:\n        operator:fivetran_provider_async.sensors.FivetranSensor\n        # Change this to your specific connector ID \n        connector_id: speak_menial\n        # Set your desired poke interval. Defaults to 60.\n        poke_interval: 60\n        fivetran_conn_id: fivetran_connection\n        # Set your dependencies for tasks. This task depends on datacoves_snowflake_google_analytics_4_trigger\n        dependencies:\n          - datacoves_snowflake_google_analytics_4_trigger\n\n  transform:\n    operator: operators.datacoves.dbt.DatacovesDbtOperator\n    type: task\n    # The daily_run_fivetran tag must be set in the source.yml\n    bash_command: "dbt build -s \'tag:daily_run_fivetran+\'"\n\n    dependencies: ["extract_and_load_fivetran"]\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},89035:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/extract_load_airflow_dag-a426c6b2871388a7748e3c08e724dcf0.png"}}]);