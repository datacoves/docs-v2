"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[239],{6232:(e,a,s)=>{s.d(a,{A:()=>r});const r=s.p+"assets/images/variablle_flow-e79d697f1b28276778a5b6eae8ec76e7.png"},28453:(e,a,s)=>{s.d(a,{R:()=>n,x:()=>i});var r=s(96540);const t={},o=r.createContext(t);function n(e){const a=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function i(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:n(e.components),r.createElement(o.Provider,{value:a},e.children)}},46170:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>n,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"how-tos/airflow/use-datacoves-secrets-manager","title":"Secrets - Datacoves secrets manager","description":"Datacoves includes a built-in Secrets Manager that allows you to securely store and manage secrets for both administrators and developers. Secrets can be stored at the project or environment level and easily shared across other tools in your stack, ensuring seamless integration and enhanced security. Creating or editing a secret in the Datacoves Secret Manager is straightforward. Be sure to prefix all secrets stored in Datacoves Secrets Manager with datacoves-.","source":"@site/docs/how-tos/airflow/use-datacoves-secrets-manager.mdx","sourceDirName":"how-tos/airflow","slug":"/how-tos/airflow/use-datacoves-secrets-manager","permalink":"/docusaurus-test/docs/how-tos/airflow/use-datacoves-secrets-manager","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":38,"frontMatter":{"title":"Secrets - Datacoves secrets manager","sidebar_position":38},"sidebar":"tutorialSidebar","previous":{"title":"Secrets - AWS Secrets Manager","permalink":"/docusaurus-test/docs/how-tos/airflow/use-aws-secrets-manager"},"next":{"title":"Worker - Custom Worker Environment","permalink":"/docusaurus-test/docs/how-tos/airflow/customize-worker-environment"}}');var t=s(74848),o=s(28453);const n={title:"Secrets - Datacoves secrets manager",sidebar_position:38},i="How to use Datacoves Secrets Manager in Airflow",c={},l=[{value:"Read variable from Datacoves Secrets Manager",id:"read-variable-from-datacoves-secrets-manager",level:2},{value:"The order of places it will look for are as follows:",id:"the-order-of-places-it-will-look-for-are-as-follows",level:3},{value:"Best practices when using a Secrets Manager variable",id:"best-practices-when-using-a-secrets-manager-variable",level:3},{value:"Example DAG using Datacoves Secrets Manager",id:"example-dag-using-datacoves-secrets-manager",level:3}];function d(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.header,{children:(0,t.jsx)(a.h1,{id:"how-to-use-datacoves-secrets-manager-in-airflow",children:"How to use Datacoves Secrets Manager in Airflow"})}),"\n",(0,t.jsxs)(a.p,{children:["Datacoves includes a built-in ",(0,t.jsx)(a.a,{href:"/docusaurus-test/docs/reference/admin-menu/secrets",children:"Secrets Manager"})," that allows you to securely store and manage secrets for both administrators and developers. Secrets can be stored at the project or environment level and easily shared across other tools in your stack, ensuring seamless integration and enhanced security. ",(0,t.jsx)(a.a,{href:"/docusaurus-test/docs/how-tos/datacoves/how_to_secrets",children:"Creating or editing a secret"})," in the Datacoves Secret Manager is straightforward. Be sure to prefix all secrets stored in Datacoves Secrets Manager with ",(0,t.jsx)(a.code,{children:"datacoves-"}),"."]}),"\n",(0,t.jsx)(a.h2,{id:"read-variable-from-datacoves-secrets-manager",children:"Read variable from Datacoves Secrets Manager"}),"\n",(0,t.jsxs)(a.p,{children:["Once you save your variable in the Datacoves Secret Manager you are ready to use your variable in a DAG. This is done using ",(0,t.jsx)(a.code,{children:"Variable.get"}),". Airflow will look in several places to find the variable."]}),"\n",(0,t.jsx)(a.h3,{id:"the-order-of-places-it-will-look-for-are-as-follows",children:"The order of places it will look for are as follows:"}),"\n",(0,t.jsxs)(a.ol,{children:["\n",(0,t.jsx)(a.li,{children:"AWS Secrets Manager (if configured)"}),"\n",(0,t.jsx)(a.li,{children:"Datacoves Secrets Manager"}),"\n",(0,t.jsx)(a.li,{children:"Airflow variables"}),"\n"]}),"\n",(0,t.jsx)(a.p,{children:"Once a variable is found, Airflow will stop its search."}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.img,{alt:"Secrets flowchart",src:s(6232).A+"",width:"1560",height:"840"})}),"\n",(0,t.jsx)(a.h3,{id:"best-practices-when-using-a-secrets-manager-variable",children:"Best practices when using a Secrets Manager variable"}),"\n",(0,t.jsxs)(a.ol,{children:["\n",(0,t.jsxs)(a.li,{children:["Always call your ",(0,t.jsx)(a.code,{children:"Variable.get"})," from within the Datacoves Task Decorators. This ensures the variable is only fetched at runtime."]}),"\n",(0,t.jsxs)(a.li,{children:["Use prefixes based on where your variable is stored, like ",(0,t.jsx)(a.code,{children:"datacoves-"})," (Datacoves Secrets Manager only searches for secrets with this prefix), ",(0,t.jsx)(a.code,{children:"aws_"}),", or ",(0,t.jsx)(a.code,{children:"airflow_"})," to help identify and debug variables. For example: ",(0,t.jsx)(a.code,{children:"datacoves-mayras_secret"}),"."]}),"\n"]}),"\n",(0,t.jsx)(a.h3,{id:"example-dag-using-datacoves-secrets-manager",children:"Example DAG using Datacoves Secrets Manager"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-python",children:'from airflow.decorators import dag, task\nfrom pendulum import datetime\nfrom airflow.models import Variable\n\n@dag(\n    default_args={\n        "start_date": datetime(2024, 1, 1),\n        "owner": "Amy Chan",\n        "email": "amy@example.com",\n        "email_on_failure": True,\n    },\n    catchup=False,\n    tags=["version_1"],\n    description="Testing task decorators",\n    schedule_interval="0 0 1 */12 *",\n)\ndef task_decorators_example():\n\n    @task.datacoves_bash\n    def calling_vars_in_decorator() -> str:\n        my_var = Variable.get("datacoves-mayras_secret")\n        return "My variable is: " + my_var\n\n    calling_vars_in_decorator()\n\ndag = task_decorators_example()\n'})}),"\n",(0,t.jsx)(a.admonition,{type:"tip",children:(0,t.jsxs)(a.p,{children:["To auto mask your secret you can use ",(0,t.jsx)(a.code,{children:"secret"})," or ",(0,t.jsx)(a.code,{children:"password"})," in the secret name since this will set ",(0,t.jsx)(a.code,{children:"hide_sensitive_var_conn_fields"})," to True. eg ",(0,t.jsx)(a.code,{children:"aws_mayras_password"}),". Please see ",(0,t.jsx)(a.a,{href:"https://www.astronomer.io/docs/learn/airflow-variables#hide-sensitive-information-in-airflow-variables",children:"this documentation"})," for a full list of masking words."]})})]})}function h(e={}){const{wrapper:a}={...(0,o.R)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);